<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ˆë“± ë¶„ìˆ˜ ë§ˆìŠ¤í„° ì•±</title>

    <!-- Google Fonts HTTPS ì™„ì „ í˜¸í™˜ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Nanum Gothic', sans-serif;
            background-color: #f0f8ff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            user-select: none;
        }

        .main-container {
            width: 90%;
            max-width: 600px;
            background-color: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        button {
            font-family: 'Nanum Gothic', sans-serif;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.1s ease;
            color: white;
            font-weight: bold;
        }

        button:active { transform: scale(0.98); }

        .hidden { display: none !important; }

        /* ë©”ë‰´ */
        #menu-screen { text-align: center; padding: 30px; }
        .menu-buttons button {
            display: block;
            width: 80%;
            margin: 20px auto;
            padding: 20px;
            font-size: 1.5rem;
            background-color: #5bc0de;
        }

        /* ë¶„ìˆ˜ í‘œì‹œ */
        .fraction-display {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            min-height: 80px;
        }
        .whole-number {
            font-size: 5rem;
            font-weight: bold;
            margin-right: 10px;
        }
        .fraction {
            display: inline-flex;
            flex-direction: column;
            text-align: center;
            font-size: 2.8rem;
        }
        .numerator { padding: 0 10px; border-bottom: 3px solid black; }
        .denominator { padding: 0 10px; }

        /* í”¼ì ì˜ì—­ */
        #pizza-area {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding: 10px;
            min-height: 200px;
        }
        .pizza-unit {
            min-width: 180px;
            height: 180px;
            border-radius: 50%;
            background-color: #fce8bf;
            border: 3px solid #a0522d;
            position: relative;
        }
        .pizza-svg { position: absolute; top:0; left:0; }
        .slice-path { fill: none; stroke:#a0522d; stroke-width: 0.5; }
        .slice-path.filled { fill: rgba(220,20,60,0.7); stroke: rgba(180,10,40); }

        /* í€´ì¦ˆ */
        .status-bar {
            display: flex;
            justify-content: space-between;
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            padding-bottom: 20px;
            border-bottom: 2px dashed #ddd;
        }
        #timer { color: #d9534f; }
        #score { color: #0275d8; }

        .answer-buttons button {
            padding: 20px;
            font-size: 1.5rem;
        }
        .btn-proper { background-color: #f0ad4e; }
        .btn-improper { background-color: #5cb85c; }
        .btn-whole { background-color: #5bc0de; }
        .btn-mixed { background-color: #d9534f; }

        #quiz-note {
            text-align: center;
            font-size: 0.95rem;
            color: #0275d8;
            font-weight: bold;
            margin-bottom: 15px;
            padding:10px;
            border:1px solid #d9edf7;
            background:#f7fcfd;
            border-radius: 8px;
        }
    </style>
</head>

<body>
<div class="main-container">

    <!-- ë©”ë‰´ -->
    <div id="menu-screen">
        <h1>ğŸ• ì´ˆë“± ë¶„ìˆ˜ ë§ˆìŠ¤í„°</h1>
        <div class="menu-buttons">
            <button id="go-learn-button">ğŸ“š ë¶„ìˆ˜ ë°°ìš°ê¸° (í”¼ì ì²´í—˜)</button>
            <button id="go-quiz-button">â±ï¸ í™•ì¸í•˜ê¸° (í€´ì¦ˆ ë„ì „)</button>
        </div>
    </div>

    <!-- LEARN -->
    <div id="learn-container" class="hidden">
        <button id="learn-to-menu" style="background:#6c757d; padding:5px 10px; margin-bottom:20px;">ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°</button>

        <div class="fraction-concept-area">
            <div class="fraction-display" id="learn-fraction-display">
                <span class="whole-number hidden" id="learn-whole"></span>
                <div class="fraction">
                    <span class="numerator" id="learn-num">0</span>
                    <span class="denominator" id="learn-den">4</span>
                </div>
            </div>
            <p id="concept-text" style="font-size:1.5rem; font-weight:bold;">ë¶„ëª¨ë¥¼ ì„¤ì •í•˜ê³  ì¡°ê°ì„ ì›€ì§ì—¬ ë³´ì„¸ìš”!</p>
        </div>

        <div id="pizza-area"></div>

        <div class="control-buttons">
            <button id="add-slice" style="font-size:2rem; padding:10px 30px; background:#0275d8;">+</button>
            <button id="remove-slice" style="font-size:2rem; padding:10px 30px; background:#0275d8;">-</button>

            <input type="number" id="denominator-input" value="4" min="2" max="12"
                   style="width:60px; padding:8px; font-size:1.2rem; text-align:center; border-radius:8px;">
            <button id="set-custom-denominator" style="background:#f0ad4e; padding:8px 15px;">ë¶„ëª¨ ì„¤ì •</button>
        </div>
    </div>

    <!-- QUIZ -->
    <div id="quiz-container" class="hidden">
        <button id="quiz-to-menu" style="background:#6c757d; padding:5px 10px; margin-bottom:20px;">ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°</button>

        <div id="start-screen">
            <h2>ì•Œì­ë‹¬ì­ ë¶„ìˆ˜ í€´ì¦ˆ!</h2>

            <div style="font-size:1.2rem; font-weight:bold; color:#555; margin-bottom:20px;">
                <p>30ì´ˆ ìµœê³  ì ìˆ˜: <span id="high-score-30">0</span>ì </p>
                <p>60ì´ˆ ìµœê³  ì ìˆ˜: <span id="high-score-60">0</span>ì </p>
            </div>

            <p>ëª‡ ì´ˆ ë™ì•ˆ ë„ì „í• ê¹Œìš”?</p>

            <label><input type="radio" name="quiz-duration" value="30" checked> 30ì´ˆ</label>
            <label style="margin-left:20px;"><input type="radio" name="quiz-duration" value="60"> 60ì´ˆ</label>

            <button id="quiz-start-button" style="background:#0275d8; padding:20px 40px; font-size:1.8rem; margin-top:20px; width:80%;">í€´ì¦ˆ ì‹œì‘!</button>
        </div>

        <div class="status-bar hidden">
            <div id="timer">ë‚¨ì€ ì‹œê°„: <span>60</span>ì´ˆ</div>
            <div id="score">ì ìˆ˜: <span>0</span>ì </div>
        </div>

        <div class="question-area hidden">
            <div class="fraction-display">
                <span class="whole-number hidden"></span>
                <div class="fraction">
                    <span class="numerator"></span>
                    <span class="denominator"></span>
                </div>
            </div>
        </div>

        <div id="feedback" class="feedback"></div>

        <div id="quiz-note">ğŸ’¡ ìì—°ìˆ˜ì™€ ê°€ë¶„ìˆ˜ê°€ ëª¨ë‘ ë  ìˆ˜ ìˆëŠ” ê²½ìš°, ì •ë‹µì€ â€˜ìì—°ìˆ˜â€™ì…ë‹ˆë‹¤.</div>

        <div class="answer-buttons hidden">
            <button class="btn-proper" data-answer="proper">ì§„ë¶„ìˆ˜</button>
            <button class="btn-improper" data-answer="improper">ê°€ë¶„ìˆ˜</button>
            <button class="btn-whole" data-answer="whole">ìì—°ìˆ˜</button>
            <button class="btn-mixed" data-answer="mixed">ëŒ€ë¶„ìˆ˜</button>
        </div>

        <div id="result-screen" class="hidden">
            <h2>ê²Œì„ ë!</h2>
            <h3 id="final-score-text">ë‹¹ì‹ ì˜ ì ìˆ˜ëŠ” <span id="final-score" style="font-size:3rem; font-weight:bold; color:#d9534f;">0</span>ì ì…ë‹ˆë‹¤.</h3>
            <button id="restart-button" style="background:#5cb85c; padding:10px 20px;">ë‹¤ì‹œ ì‹œì‘</button>
        </div>
    </div>

</div>


<script>

let menuScreen, learnContainer, quizContainer, pizzaArea;
let goLearnButton, goQuizButton, learnToMenuButton, quizToMenuButton;
let quizStartButton, restartButton;
let learnNumEl, learnDenEl, conceptTextEl;
let addSliceButton, removeSliceButton, denominatorInput, setCustomDenButton;

let currentNumerator = 0;
let currentDenominator = 4;

document.addEventListener("DOMContentLoaded", () => {

    menuScreen = document.getElementById("menu-screen");
    learnContainer = document.getElementById("learn-container");
    quizContainer = document.getElementById("quiz-container");
    pizzaArea = document.getElementById("pizza-area");

    goLearnButton = document.getElementById("go-learn-button");
    goQuizButton = document.getElementById("go-quiz-button");
    learnToMenuButton = document.getElementById("learn-to-menu");
    quizToMenuButton = document.getElementById("quiz-to-menu");

    learnNumEl = document.getElementById("learn-num");
    learnDenEl = document.getElementById("learn-den");
    conceptTextEl = document.getElementById("concept-text");

    addSliceButton = document.getElementById("add-slice");
    removeSliceButton = document.getElementById("remove-slice");
    denominatorInput = document.getElementById("denominator-input");
    setCustomDenButton = document.getElementById("set-custom-denominator");

    goLearnButton.onclick = () => showScreen("learn-container");
    goQuizButton.onclick = () => showScreen("quiz-container");
    learnToMenuButton.onclick = () => showScreen("menu-screen");
    quizToMenuButton.onclick = () => showScreen("menu-screen");

    addSliceButton.onclick = () => updateFraction(1);
    removeSliceButton.onclick = () => updateFraction(-1);
    setCustomDenButton.onclick = setDen;

    showScreen("menu-screen");
});

function showScreen(id){
    document.querySelectorAll(".main-container > div").forEach(x => x.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");

    if(id==="learn-container"){
        drawPizza();
        updateConcept();
    }
}

function setDen(){
    let v = parseInt(denominatorInput.value);
    if(v<2||v>12||isNaN(v)) return;
    currentDenominator = v;
    currentNumerator = 0;
    drawPizza();
    updateConcept();
}

function updateFraction(n){
    if(currentNumerator+n < 0) return;
    currentNumerator += n;
    drawPizza();
    updateConcept();
}

function drawPizza(){
    pizzaArea.innerHTML = "";
    let whole = Math.floor(currentNumerator/currentDenominator);
    let remain = currentNumerator%currentDenominator;
    let total = whole + (remain>0?1:1);

    for(let i=0;i<total;i++){
        let div = document.createElement("div");
        div.className="pizza-unit";
        let svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
        svg.setAttribute("viewBox","0 0 100 100");
        svg.classList.add("pizza-svg");

        let fillCount = (i < whole) ? currentDenominator : (i===whole?remain:0);

        for(let j=0;j<currentDenominator;j++){
            let path = createSlice(j,currentDenominator);
            if(j<fillCount) path.classList.add("filled");
            svg.appendChild(path);
        }
        div.appendChild(svg);
        pizzaArea.appendChild(div);
    }
}

function createSlice(index,den){
    const angle = 360/den;
    const start = index*angle;
    const end = start+angle;

    const R=50, CX=50, CY=50;
    const p2c = (cx,cy,r,a)=>({x:cx+r*Math.cos((a-90)*Math.PI/180), y:cy+r*Math.sin((a-90)*Math.PI/180)});

    let st = p2c(CX,CY,R,start);
    let en = p2c(CX,CY,R,end);

    let path = document.createElementNS("http://www.w3.org/2000/svg","path");
    let d = `M ${CX} ${CY} L ${st.x} ${st.y} A ${R} ${R} 0 0 1 ${en.x} ${en.y} Z`;
    path.setAttribute("d",d);
    path.classList.add("slice-path");
    return path;
}

function updateConcept(){
    learnNumEl.textContent = currentNumerator;
    learnDenEl.textContent = currentDenominator;

    if(currentNumerator===0){
        conceptTextEl.textContent="ë¶„ëª¨ë¥¼ ì„¤ì •í•˜ê³  '+' ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”!";
        return;
    }

    let whole = Math.floor(currentNumerator/currentDenominator);
    let remain = currentNumerator%currentDenominator;

    if(whole>0 && remain===0){
        conceptTextEl.textContent=`ë”± ${whole}íŒ! ìì—°ìˆ˜ì˜ˆìš”.`;
    } else if(currentNumerator>currentDenominator){
        conceptTextEl.textContent="ë¶„ìê°€ ë” ì»¤ìš”! ì´ê²ƒì€ ê°€ë¶„ìˆ˜ì…ë‹ˆë‹¤.";
    } else {
        conceptTextEl.textContent="í•œ íŒë³´ë‹¤ ì‘ì•„ìš”! ì§„ë¶„ìˆ˜ì…ë‹ˆë‹¤.";
    }
}
</script>
</body>
</html>

